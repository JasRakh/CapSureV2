# Как проверить API ключ OpenAI

## Ошибка 429 (Too Many Requests)

Если вы видите ошибку **429**, это может означать:

1. **Превышен лимит запросов** - вы сделали слишком много запросов за короткое время
2. **Неправильный API ключ** - иногда неправильный ключ возвращает 429 вместо 401
3. **Нет кредитов на счету** - у вас закончились средства в OpenAI аккаунте

## Как проверить API ключ:

### Шаг 1: Проверьте формат ключа

API ключ OpenAI должен:

- Начинаться с `sk-`
- Быть длиной не менее 20 символов
- Выглядеть примерно так: `sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`

### Шаг 2: Проверьте где установлен ключ

Откройте файл `services/openaiService.ts` и проверьте строку 8:

```typescript
const OPENAI_API_KEY = process.env.EXPO_PUBLIC_OPENAI_API_KEY || '';
```

Если там пустая строка `''`, значит ключ не установлен!

### Шаг 3: Установите ключ

**Вариант 1: Прямо в коде (для тестирования)**

```typescript
const OPENAI_API_KEY =
  process.env.EXPO_PUBLIC_OPENAI_API_KEY || 'sk-ваш-ключ-здесь';
```

**Вариант 2: Через .env файл (рекомендуется)**

1. Создайте файл `.env` в корне проекта
2. Добавьте строку:

```
EXPO_PUBLIC_OPENAI_API_KEY=sk-ваш-ключ-здесь
```

3. Перезапустите сервер разработки

### Шаг 4: Проверьте баланс OpenAI

1. Зайдите на https://platform.openai.com/account/billing
2. Проверьте, есть ли у вас кредиты
3. Если кредитов нет - пополните счет

### Шаг 5: Проверьте лимиты

1. Зайдите на https://platform.openai.com/account/limits
2. Проверьте ваши rate limits
3. Если лимиты низкие - подождите несколько минут перед следующим запросом

## Быстрая проверка ключа

Вы можете проверить ключ через curl:

```bash
curl https://api.openai.com/v1/models \
  -H "Authorization: Bearer sk-ваш-ключ-здесь"
```

Если ключ правильный, вы увидите список моделей.
Если неправильный - получите ошибку 401.

## После исправления

1. Сохраните файл `services/openaiService.ts`
2. Перезапустите Expo сервер: `npm start`
3. Очистите кэш: `npm start --clear`
4. Попробуйте снова отсканировать таблетку
